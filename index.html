// ... (이전 코드 동일) ...

    // [데이터 연동] 중계 서버(API/soop_data_repeater.js) 호출
    async function checkLiveReal(data) {
        const uniqueIds = [...new Set(data.map(m=>m.id))];
        const targets = uniqueIds.map(id => {
            const org = data.find(m=>m.id===id);
            return {id: org.id, platform: org.platform};
        });
        
        try {
            // 로컬 중계 서버 호출
            const res = await fetch('http://localhost:3000/live', {
                method: 'POST', 
                headers: {'Content-Type': 'application/json'}, 
                body: JSON.stringify({items: targets})
            });
            const results = await res.json();
            
            results.forEach(r => {
                const cards = document.querySelectorAll(`.card[data-id="${r.id}"]`);
                cards.forEach(c => {
                    const badge = c.querySelector('.status-badge');
                    const fanEl = c.querySelector('.fan-cnt');
                    
                    // [수정] 애청자 수 업데이트 로직
                    // r.fans가 undefined거나 null이면 0으로 처리
                    const fanCount = (r.fans !== undefined && r.fans !== null) ? r.fans : 0;
                    
                    if(fanEl) {
                        // 0명이어도 숫자 '0'으로 표기 (하이픈(-) 제거)
                        fanEl.innerText = `애청자: ${Number(fanCount).toLocaleString()}`;
                    }

                    // 라이브 배지 업데이트
                    if(r.isLive) {
                        c.classList.add('is-live');
                        if(badge) {
                            badge.innerText = "LIVE";
                            badge.classList.remove('badge-off');
                            badge.classList.add('badge-live');
                        }
                    } else {
                        c.classList.remove('is-live');
                        if(badge) {
                            badge.innerText = "OFF";
                            badge.classList.remove('badge-live');
                            badge.classList.add('badge-off');
                        }
                    }
                });
            });
        } catch(e) { 
            console.error('API Error:', e); 
            // 에러 발생 시에도 '-'가 아닌 0으로 초기화하고 싶다면 아래 코드 추가 가능
        }
    }
    
    init();
</script>
</body>
</html>
