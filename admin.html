<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ê´€ë¦¬ í˜ì´ì§€</title>
    <style>
        /* [ê¸°ë³¸ ì„¤ì •] */
        body { background: #222; color: #fff; padding: 20px; font-family: 'Pretendard', sans-serif; max-width: 1200px; margin: 0 auto; padding-bottom: 100px; }
        
        /* [ë¡œê·¸ì¸ í™”ë©´] */
        #loginOverlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.98); z-index: 9999; display: flex; flex-direction: column; justify-content: center; align-items: center; }
        .login-box { background: #333; padding: 40px; border-radius: 10px; border: 1px solid #555; text-align: center; width: 300px; }
        
        /* [íŒ¨ë„ ê³µí†µ] */
        #adminContent { display: none; }
        .panel { 
            display: block; background: #333; padding: 20px; 
            border-radius: 10px; margin-bottom: 20px; 
            border: 1px solid #444; box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }
        
        /* [ì…ë ¥ ë„êµ¬] */
        input, select { padding: 10px; background: #444; border: 1px solid #555; color: white; border-radius: 4px; margin-right: 5px; box-sizing: border-box; }
        button { cursor: pointer; border: none; border-radius: 4px; padding: 10px 15px; color: white; font-weight: bold; transition: 0.2s; }
        button:hover { opacity: 0.8; }
        
        /* [í…Œì´ë¸”] */
        table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 0.9rem; }
        th { background: #444; padding: 10px; text-align: center; border-bottom: 2px solid #555; }
        td { border-bottom: 1px solid #555; padding: 10px; text-align: center; }
        
        /* [ê¸°íƒ€] */
        .badge { padding: 4px 8px; border-radius: 4px; font-size: 0.75rem; color:black; font-weight: bold;}
        .soop { background: #42C769; } .chzzk { background: #00E59D; }
        .highlight { color: #f1c40f; font-weight: bold; }
        .step-box { border-left: 5px solid #3498db; padding-left: 15px; margin-bottom: 20px; }
        .btn-delete { background: #c0392b; font-size: 0.8rem; padding: 5px 10px; margin-left: 5px; }

        /* [ë¡œê·¸ì°½ ìŠ¤íƒ€ì¼] */
        #static-log-window {
            display: block; height: 200px; overflow-y: scroll;
            background-color: #000; padding: 15px; border: 1px solid #555;
            font-family: 'Courier New', monospace; font-size: 13px; color: #0f0;
            line-height: 1.6; white-space: pre-wrap;
        }

        /* [ì‹ ê·œ ì¶”ê°€: ìˆ˜ì • í¼ ìŠ¤íƒ€ì¼] */
        #editFormArea { display: none; background: #2a2a2a; padding: 15px; margin-top: 10px; border-radius: 8px; border: 1px dashed #777; }
        .edit-label { display: block; margin-top: 10px; color: #aaa; font-size: 0.9rem; }
        .readonly-input { background: #222; color: #777; border: 1px solid #333; }
    </style>
</head>
<body>

    <div id="loginOverlay">
        <div class="login-box">
            <h2>ğŸ”’ ê´€ë¦¬ì ì ‘ì†</h2>
            <input type="password" id="adminPw" placeholder="Password" style="width:100%; margin-bottom:10px;" onkeyup="if(event.key==='Enter') checkLogin()">
            <button onclick="checkLogin()" style="background:#0984e3; width:100%;">ì…ì¥</button>
        </div>
    </div>

    <div id="adminContent">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
            <h2>ğŸ› ï¸ ìŠ¤íŠ¸ë¦¬ë¨¸ DB ê´€ë¦¬ì</h2>
            <a href="index.html" style="color:#aaa; text-decoration:none; font-size:1.5rem;">ğŸ </a>
        </div>

        <div class="panel" style="border: 2px solid #f1c40f;">
            <h3>ğŸ” íšŒì› ì •ë³´ ê°œë³„ ìˆ˜ì • (ê·¸ë£¹ 1,2,3)</h3>
            
            <div style="display:flex; gap:10px; align-items:center;">
                <input type="text" id="searchNick" placeholder="ë‹‰ë„¤ì„ ì…ë ¥ (ì •í™•íˆ ì…ë ¥)" style="width: 200px;">
                <button onclick="searchUser()" style="background:#f39c12;">ê²€ìƒ‰</button>
            </div>

            <div id="editFormArea">
                <h4 style="margin: 0 0 10px 0; border-bottom: 1px solid #555; padding-bottom: 5px;">ğŸ“ ìˆ˜ì •í•˜ê¸°</h4>
                
                <div style="display:flex; gap: 10px;">
                    <div style="flex:1">
                        <span class="edit-label">ID (ìˆ˜ì •ë¶ˆê°€)</span>
                        <input type="text" id="editTargetId" class="readonly-input" readonly style="width:100%">
                    </div>
                    <div style="flex:1">
                        <span class="edit-label">ë‹‰ë„¤ì„</span>
                        <input type="text" id="editViewNick" class="readonly-input" readonly style="width:100%">
                    </div>
                    <div style="flex:1">
                        <span class="edit-label">í”Œë«í¼</span>
                        <select id="editPlatform" style="width:100%">
                            <option value="soop">SOOP</option>
                            <option value="chzzk">CHZZK</option>
                        </select>
                    </div>
                </div>

                <span class="edit-label" style="color:#fff;">ğŸ“ í†µí•© ê·¸ë£¹ëª… (ê¸°ì¡´ group_name)</span>
                <input type="text" id="editGroupName" style="width:100%;" placeholder="ì˜ˆ: 1ê¸°, 2ê¸° (ì‰¼í‘œ êµ¬ë¶„)">

                <div style="display:flex; gap:10px; margin-top:5px;">
                    <div style="flex:1">
                        <span class="edit-label">ê·¸ë£¹ 1</span>
                        <input type="text" id="editG1" style="width:100%">
                    </div>
                    <div style="flex:1">
                        <span class="edit-label">ê·¸ë£¹ 2</span>
                        <input type="text" id="editG2" style="width:100%">
                    </div>
                    <div style="flex:1">
                        <span class="edit-label">ê·¸ë£¹ 3</span>
                        <input type="text" id="editG3" style="width:100%">
                    </div>
                </div>

                <div style="text-align:right; margin-top:15px;">
                    <button onclick="saveEditChanges()" style="background:#2ecc71;">ğŸ’¾ ìˆ˜ì • ë‚´ìš© ì €ì¥</button>
                    <button onclick="document.getElementById('editFormArea').style.display='none'" style="background:#555;">ë‹«ê¸°</button>
                </div>
            </div>
        </div>
        <div class="panel" style="border: 2px solid #3498db;">
            <h3>ğŸ“ ë“±ë¡ ëŒ€ê¸° ë¦¬ìŠ¤íŠ¸ ì‘ì„± (ì‹ ê·œ ë“±ë¡)</h3>
            <div class="step-box">
                <div style="margin-bottom:10px;"><span class="highlight">STEP 1. ê·¸ë£¹ ìƒì„± (ë¡œì»¬)</span></div>
                <input type="text" id="localGroupName" placeholder="ìƒˆ ê·¸ë£¹ëª…" style="width: 200px;">
                <button onclick="addGroupLocal()" style="background:#2ecc71;">â• ê·¸ë£¹ ì¶”ê°€</button>
                <div id="groupBadgeArea" style="margin-top:10px;"></div>
            </div>
            <div class="step-box">
                <div style="margin-bottom:10px;"><span class="highlight">STEP 2. ìŠ¤íŠ¸ë¦¬ë¨¸ ì¶”ê°€</span></div>
                <select id="selGroup"><option value="">ê·¸ë£¹ ì„ íƒ</option></select>
                <select id="selPlatform">
                    <option value="soop">SOOP (ìˆ²)</option>
                    <option value="chzzk">CHZZK (ì¹˜ì§€ì§)</option>
                </select>
                <input type="text" id="inpId" placeholder="ìŠ¤íŠ¸ë¦¬ë¨¸ ID" style="width:150px;">
                <button onclick="lookupAndAdd()" style="background:#3498db;">â¬‡ï¸ ë¦¬ìŠ¤íŠ¸ì— ë‹´ê¸°</button>
            </div>
            <table style="margin-top:20px; background:#2a3b4c;">
                <thead>
                    <tr><th colspan="5" style="background:#2980b9;">ğŸ’¾ ì €ì¥ ëŒ€ê¸° ëª©ë¡</th></tr>
                    <tr><th>ê·¸ë£¹ëª…</th><th>í”Œë«í¼</th><th>ID</th><th>ë‹‰ë„¤ì„</th><th>ê´€ë¦¬</th></tr>
                </thead>
                <tbody id="draftBody"></tbody>
            </table>
            <div style="text-align:right; margin-top:15px;">
                <button onclick="saveBatch()" style="background:#e67e22; font-size:1.1rem; padding:12px 20px;">
                    ğŸ’¾ [ìµœì´ˆ ë“±ë¡] ì‹¤í–‰ (DB ì €ì¥)
                </button>
            </div>
        </div>

        <div class="panel" style="border: 2px solid #00ff00;">
            <div style="border-bottom: 1px solid #444; padding-bottom: 10px; margin-bottom: 10px;">
                <h3 style="margin:0; color: #00ff00;">ğŸ–¥ï¸ ì‹œìŠ¤í…œ ì²˜ë¦¬ ë¡œê·¸ (System Log)</h3>
            </div>
            
            <div id="static-log-window">
                [ì‹œìŠ¤í…œ ëŒ€ê¸°ì¤‘] ë¡œê·¸ì°½ì´ ì •ìƒì ìœ¼ë¡œ ë°°ì¹˜ë˜ì—ˆìŠµë‹ˆë‹¤.<br>
            </div>
        </div>

        <div class="panel" style="border: 1px solid #444;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                <h3>ğŸ“Š DB ë“±ë¡ í˜„í™© (<span id="totalCnt">0</span>ëª…)</h3>
                <button onclick="updateFull()" style="background-color: #d9534f;">
                    ğŸ”„ [ëª¨ë‘ ê°±ì‹ ] (URL ì¬ìƒì„±)
                </button>
            </div>
            <div style="overflow-x: auto;">
                <table style="width: 100%; border-collapse: collapse; font-size: 14px; text-align: center;">
                    <thead>
                        <tr style="background-color: #333; color: #ccc;">
                            <th>ê·¸ë£¹ (í†µí•©)</th>
                            <th>í”Œë«í¼</th>
                            <th>ID</th>
                            <th>ë‹‰ë„¤ì„</th>
                            <th>ìƒíƒœ / ê´€ë¦¬</th>
                        </tr>
                    </thead>
                    <tbody id="dbBody">
                        <tr><td colspan="5" style="padding: 20px; color: #999;">ë°ì´í„° ë¡œë”© ì¤‘...</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

    </div> 
    <script>
    let draftList = []; 
    let groupSet = new Set(); 

    // 1. ë¡œê·¸ì¸
    async function checkLogin() {
        try {
            const res = await fetch('admin.json');
            if(!res.ok) throw new Error("admin.json íŒŒì¼ ì—†ìŒ");
            const cfg = await res.json();
            
            if(document.getElementById('adminPw').value === cfg.password) {
                document.getElementById('loginOverlay').style.display = 'none';
                document.getElementById('adminContent').style.display = 'block';
                init(); 
            } else { alert('ë¹„ë°€ë²ˆí˜¸ ë¶ˆì¼ì¹˜'); }
        } catch(e) { alert('ë¡œê·¸ì¸ ì˜¤ë¥˜: ' + e.message); }
    }

    async function init() { await loadDBList(); }

    // ===============================================
    // [ì‹ ê·œ ê¸°ëŠ¥] ë‹‰ë„¤ì„ ê²€ìƒ‰ ë° ìˆ˜ì • ë¡œì§
    // ===============================================
    async function searchUser() {
        const nickname = document.getElementById('searchNick').value.trim();
        if(!nickname) return alert('ë‹‰ë„¤ì„ì„ ì…ë ¥í•˜ì„¸ìš”.');

        try {
            const res = await fetch('/api/search_nick', {
                method: 'POST', headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ nickname })
            });
            const data = await res.json();

            if(res.ok) {
                document.getElementById('editTargetId').value = data.id;
                document.getElementById('editViewNick').value = data.nickname;
                document.getElementById('editPlatform').value = data.platform || 'soop';
                
                document.getElementById('editGroupName').value = data.group_name || '';
                document.getElementById('editG1').value = data.group_1 || '';
                document.getElementById('editG2').value = data.group_2 || '';
                document.getElementById('editG3').value = data.group_3 || '';

                document.getElementById('editFormArea').style.display = 'block';
            } else {
                alert(data.error);
                document.getElementById('editFormArea').style.display = 'none';
            }
        } catch(e) { alert('ì˜¤ë¥˜: ' + e.message); }
    }

    async function saveEditChanges() {
        if(!confirm('í•´ë‹¹ íšŒì›ì˜ ì •ë³´ë¥¼ ìˆ˜ì •í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;

        const bodyData = {
            id: document.getElementById('editTargetId').value,
            platform: document.getElementById('editPlatform').value,
            group_name: document.getElementById('editGroupName').value.trim(),
            group_1: document.getElementById('editG1').value.trim(),
            group_2: document.getElementById('editG2').value.trim(),
            group_3: document.getElementById('editG3').value.trim()
        };

        try {
            const res = await fetch('/api/update_member', {
                method: 'POST', headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(bodyData)
            });
            const result = await res.json();

            if(res.ok) {
                alert(result.message);
                loadDBList(); // ë¦¬ìŠ¤íŠ¸ ê°±ì‹ 
            } else {
                alert('ì €ì¥ ì‹¤íŒ¨: ' + result.error);
            }
        } catch(e) { alert('ì €ì¥ ì˜¤ë¥˜: ' + e.message); }
    }
    // ===============================================


    // 2. ê·¸ë£¹ ê´€ë¦¬ (ê¸°ì¡´)
    function addGroupLocal() {
        const name = document.getElementById('localGroupName').value.trim();
        if(!name) return alert('ê·¸ë£¹ëª…ì„ ì…ë ¥í•˜ì„¸ìš”.');
        groupSet.add(name); 
        renderGroups();
        document.getElementById('localGroupName').value = '';
    }

    function renderGroups() {
        const badgeArea = document.getElementById('groupBadgeArea');
        if(badgeArea) {
            badgeArea.innerHTML = '';
            [...groupSet].forEach(g => {
                badgeArea.innerHTML += `<span style="background:#555; padding:5px 10px; border-radius:15px; font-size:0.8rem; margin-right:5px;">ğŸ“‚ ${g}</span>`;
            });
        }
        const sel = document.getElementById('selGroup');
        sel.innerHTML = '<option value="">ê·¸ë£¹ ì„ íƒ</option>';
        [...groupSet].sort().forEach(g => {
            sel.innerHTML += `<option value="${g}">${g}</option>`;
        });
    }

    // 3. ë¦¬ìŠ¤íŠ¸ì— ë‹´ê¸° (ê¸°ì¡´)
    async function lookupAndAdd() {
        const group_name = document.getElementById('selGroup').value;
        const platform = document.getElementById('selPlatform').value;
        const idInput = document.getElementById('inpId');
        
        if (!idInput) return alert('HTML ì—ëŸ¬: ì…ë ¥ì°½ ì—†ìŒ');
        const id = idInput.value.trim();

        if(!group_name) return alert('ê·¸ë£¹ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
        if(!id) return alert('IDë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        if(draftList.find(d => d.id === id)) return alert('ì´ë¯¸ ì…ë ¥ ëª©ë¡ì— ìˆëŠ” ëŒ€ìƒì…ë‹ˆë‹¤.');

        try {
            const res = await fetch('/api/lookup', {
                method: 'POST', headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ id: id, platform: platform }) 
            });

            if (!res.ok) {
                const errData = await res.json();
                throw new Error(errData.error || 'ì¡°íšŒ ì˜¤ë¥˜');
            }
            const data = await res.json();
            if(data.status === 'duplicate') return alert('ì´ë¯¸ DBì— ë“±ë¡ëœ ìŠ¤íŠ¸ë¦¬ë¨¸ì…ë‹ˆë‹¤.');

            draftList.push({
                group_name: group_name,
                platform: platform,
                id: id,
                nickname: data.nickname || id
            });
            renderDraft();
            document.getElementById('inpId').value = ''; 
        } catch(e) { alert('ì¡°íšŒ ì‹¤íŒ¨: ' + e.message); }
    }

    function renderDraft() {
        const tbody = document.getElementById('draftBody');
        tbody.innerHTML = draftList.map((item, idx) => `
            <tr>
                <td style="color:#f1c40f;">${item.group_name}</td>
                <td><span class="badge ${item.platform}">${item.platform}</span></td>
                <td>${item.id}</td>
                <td>${item.nickname}</td>
                <td><button onclick="removeDraft(${idx})" style="background:#e74c3c; padding:4px 8px; font-size:0.8rem;">ì·¨ì†Œ</button></td>
            </tr>
        `).join('');
    }

    function removeDraft(idx) {
        draftList.splice(idx, 1);
        renderDraft();
    }

    // 4. ì €ì¥ (ìµœì´ˆ ë“±ë¡)
    async function saveBatch() {
        if(draftList.length === 0) return alert('ëª©ë¡ì´ ë¹„ì—ˆìŠµë‹ˆë‹¤.');
        const btn = document.querySelector('button[onclick="saveBatch()"]');
        btn.innerText = 'â³ ì €ì¥ ì¤‘...'; btn.disabled = true;

        try {
            const res = await fetch('/api/register_batch', {
                method: 'POST', headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ items: draftList })
            });
            const result = await res.json();
            if(res.ok) {
                alert(`âœ… ${result.count || 'ì™„ë£Œ'} ì €ì¥ ì™„ë£Œ!`);
                draftList = []; renderDraft(); loadDBList(); 
            } else { throw new Error(result.error || 'ì €ì¥ ì‹¤íŒ¨'); }
        } catch(e) { alert('ì˜¤ë¥˜: ' + e.message); }
        btn.innerText = 'ğŸ’¾ [ìµœì´ˆ ë“±ë¡] ì‹¤í–‰'; btn.disabled = false;
    }

    // 5. ì‚­ì œ
    async function deleteStreamer(id) {
        if(!confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
        try {
            const res = await fetch('/api/delete_streamer', {
                method: 'POST', headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ id: id })
            });
            if(res.ok) { loadDBList(); } 
            else { 
                const err = await res.json(); 
                alert('ì‚­ì œ ì‹¤íŒ¨: ' + err.error); 
            }
        } catch(e) { alert('ì‚­ì œ ì˜¤ë¥˜: ' + e.message); }
    }



        // 6. DB ëª©ë¡ ë¡œë“œ (ì¤‘ë³µ ì œê±° ë¡œì§ ê°•í™”)
    async function loadDBList() {
        try {
            const res = await fetch('/api/get_list');
            const data = await res.json();
            
            // [ì¤‘ë³µ ë°©ì§€] Setì„ ì‚¬ìš©í•˜ë©´ ìë™ìœ¼ë¡œ ì¤‘ë³µëœ ê°’ì€ ë¬´ì‹œë©ë‹ˆë‹¤.
            groupSet = new Set(); 

            data.forEach(m => {
                // ê³µí†µ ì¶”ê°€ í•¨ìˆ˜ (ê³µë°± ì œê±° + ë¹ˆê°’ ì²´í¬)
                const addGroupSafe = (text) => {
                    if (!text) return; // ë‚´ìš© ì—†ìœ¼ë©´ íŒ¨ìŠ¤
                    const cleanName = text.trim();
                    if (cleanName) groupSet.add(cleanName); // Setì´ ì•Œì•„ì„œ ì¤‘ë³µ ì œê±°í•¨
                };

                // 1. ê¸°ì¡´ group_name (ì‰¼í‘œë¡œ ìª¼ê°œì„œ ë„£ê¸°)
                if (m.group_name) {
                    m.group_name.split(',').forEach(g => addGroupSafe(g));
                }

                // 2. group_1, 2, 3 ì¶”ê°€ (ì´ë¯¸ ìˆëŠ” ì´ë¦„ì´ë©´ Setì´ ì•Œì•„ì„œ ì œì™¸í•¨)
                addGroupSafe(m.group_1);
                addGroupSafe(m.group_2);
                addGroupSafe(m.group_3);
            });

            // í™”ë©´ ê°±ì‹  (ê·¸ë£¹ ë°°ì§€, ì„ íƒì°½)
            renderGroups();
            
            document.getElementById('totalCnt').innerText = data.length;
            
            // í…Œì´ë¸” ê·¸ë¦¬ê¸°
            document.getElementById('dbBody').innerHTML = data.map(m => `
                <tr>
                    <td style="color:#f1c40f;">${m.group_name || '-'}</td>
                    <td><span class="badge ${m.platform}">${m.platform}</span></td>
                    <td>${m.id}</td>
                    <td>${m.nickname || '-'}</td>
                    <td>
                        <button class="btn-delete" onclick="deleteStreamer('${m.id}')">ì‚­ì œ</button>
                    </td>
                </tr>
            `).join('');

        } catch(e) { console.error(e); }
    }
        
    // 7. ëª¨ë‘ ê°±ì‹  (ìˆ˜ì •ë¨: DB ëª…ë‹¨ ê°€ì ¸ì™€ì„œ ì²˜ë¦¬)
    async function updateFull() {
        if(!confirm('DBì— ìˆëŠ” ëª¨ë“  ìŠ¤íŠ¸ë¦¬ë¨¸ ì •ë³´ë¥¼ ê°±ì‹ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;

        const logWindow = document.getElementById('static-log-window');
        const btn = document.querySelector('button[onclick="updateFull()"]');

        if(logWindow) {
            logWindow.innerHTML = "ğŸ”„ [1/3] í˜„ì¬ DB ëª©ë¡ ê°€ì ¸ì˜¤ëŠ” ì¤‘...<br>";
            logWindow.scrollTop = logWindow.scrollHeight;
        }
        if(btn) btn.innerText = 'â³ ëª©ë¡ í™•ë³´ ì¤‘...';

        try {
            const listRes = await fetch('/api/get_list');
            const currentList = await listRes.json();

            if (!currentList || currentList.length === 0) {
                if(logWindow) logWindow.innerHTML += "âŒ DBì— ì €ì¥ëœ ìŠ¤íŠ¸ë¦¬ë¨¸ê°€ ì—†ìŠµë‹ˆë‹¤.<br>";
                return;
            }

            if(logWindow) logWindow.innerHTML += `ğŸ”„ [2/3] ì´ ${currentList.length}ëª… ë°ì´í„° ì„œë²„ë¡œ ì „ì†¡...<br>`;

            const res = await fetch('/api/register_batch', { 
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ items: currentList })
            });
            const json = await res.json();

            if(logWindow && json.logs && Array.isArray(json.logs)) {
                logWindow.innerHTML = ""; 
                json.logs.forEach(msg => {
                    let style = "color: #ccc;";
                    if(msg.includes('ì—ëŸ¬') || msg.includes('ì‹¤íŒ¨')) style = "color: #ff5555; font-weight:bold;";
                    else if(msg.includes('ì„±ê³µ')) style = "color: #55ff55; font-weight:bold;";
                    else if(msg.includes('ì£¼ì†Œ')) style = "color: #ffff00;"; 
                    else if(msg.includes('SOOP')) style = "color: #00ffff;";

                    logWindow.innerHTML += `<div style="${style}">${msg}</div>`;
                });
                logWindow.innerHTML += "<br>âœ… <strong>ëª¨ë“  ì‘ì—…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.</strong>";
                logWindow.scrollTop = logWindow.scrollHeight; 
            } else {
                if(logWindow) logWindow.innerHTML += `<br>âš ï¸ ì„œë²„ ë¡œê·¸ ì—†ìŒ: ${JSON.stringify(json)}`;
            }
        } catch (e) {
            if(logWindow) logWindow.innerHTML += `<br>âŒ [ì¹˜ëª…ì  ì—ëŸ¬] ${e.message}`;
            console.error(e);
        } finally {
            if(btn) btn.innerText = 'ğŸ”„ [ëª¨ë‘ ê°±ì‹ ]';
            loadDBList(); 
        }
    }
</script>   
</body>
</html>
